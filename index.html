<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JavaScript Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: sans-serif;
      font-weight: bold;
    }
    body{
      width: 100%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: url(https://png.pngtree.com/thumb_back/fh260/background/20230411/pngtree-nature-forest-sun-ecology-image_2256183.jpg);
      background-size: cover;
    }
    .calculator{
      padding: 20px;
      border: 2px solid #000;
      border-radius: 16px;
      box-shadow: 0px 3px 15px rgba(0, 0, 0, 0.8);
      background: rgba(0, 0, 0, 0.5);
    }
    input{
      width: 320px;
      padding: 24px;
      margin: 10px;
      background: rgba(255, 255, 255, 0.3);
      box-shadow: inset 0px 0px 8px rgba(0, 0, 0, 0.4);
      font-size: 48px;
      text-align: right;
      color: #fff;
      border: solid 2px rgba(0, 0, 0, 0.3);
      border-radius: 16px;
      text-shadow: 0px 1px 5px rgba(0, 0, 0, 0.2);
    }
    input::placeholder{ color: #fff; }
    .keys { display: grid; grid-template-columns: repeat(4, 1fr); }
    button{
      width: 60px;
      height: 60px;
      margin: 10px;
      color: #fff;
      background: rgba(0, 0, 0, 0.7);
      font-size: 24px;
      cursor: pointer;
      border: solid 1px rgba(255, 255, 255, 0.2);
      border-radius: 25px;
      text-shadow: 0px 1px 5px rgba(0, 0, 0, 0.2);
      box-shadow: -1px 2px 10px rgba(0, 0, 0, 0.5);
      user-select: none;
      outline: none;
    }
    .ac, .del{ font-size: 20px; }
    button:hover{ color: #fff; background: #94a053; }
    .equalBtn{ background: #94a053; }
    .operator{ color: #94a053; }
    .pressed { transform: translateY(1px) scale(0.98); }
  </style>
</head>
<body>
  <div class="calculator" role="application" aria-label="Calculator">
    <input type="text" placeholder="0" id="inputBox" readonly aria-readonly="true" aria-label="Calculator display" />
    <div class="keys">
      <button class="operator ac" data-action="ac" aria-label="All Clear">AC</button>
      <button class="operator del" data-action="del" aria-label="Delete last">DEL</button>
      <button class="operator" data-val="%">%</button>
      <button class="operator" data-val="/">/</button>

      <button data-val="7">7</button>
      <button data-val="8">8</button>
      <button data-val="9">9</button>
      <button class="operator" data-val="*">*</button>

      <button data-val="4">4</button>
      <button data-val="5">5</button>
      <button data-val="6">6</button>
      <button class="operator" data-val="-">-</button>

      <button data-val="1">1</button>
      <button data-val="2">2</button>
      <button data-val="3">3</button>
      <button class="operator" data-val="+">+</button>

      <button data-val="00">00</button>
      <button data-val="0">0</button>
      <button data-val=".">.</button>
      <button class="equalBtn" data-action="eq" aria-label="Equals">=</button>
    </div>
  </div>

  <script>
    (function(){
      const inputBox = document.getElementById('inputBox');
      let expression = '';

      function updateExpression(value) {
        expression += value;
        inputBox.value = expression;
      }

      function calculateResult() {
        try {
          // Basic safety: only allow numbers, operators, decimal points, parentheses, and spaces
          if (!/^[\d+\-*/%.() \t]+$/.test(expression)) {
            throw new Error('Invalid chars');
          }
          // Evaluate
          const result = Function('"use strict";return (' + expression + ')')();
          if (result === undefined || Number.isNaN(result) || !Number.isFinite(result)) {
            throw new Error('Math error');
          }
          inputBox.value = result;
          expression = result.toString();
        } catch (e) {
          inputBox.value = 'Error';
          expression = '';
        }
      }

      function clearInput() {
        expression = '';
        inputBox.value = '';
      }

      function deleteLastChar() {
        expression = expression.slice(0, -1);
        inputBox.value = expression;
      }

      // Click support
      document.querySelectorAll('button').forEach(button => {
        button.addEventListener('click', () => {
          const action = button.dataset.action;
          const val = button.dataset.val;

          if (action === 'ac') {
            clearInput();
          } else if (action === 'del') {
            deleteLastChar();
          } else if (action === 'eq') {
            calculateResult();
          } else if (val != null) {
            updateExpression(val);
          }
        });
      });

      // Keyboard support (includes numpad)
      const allowedKeys = new Set([
        '0','1','2','3','4','5','6','7','8','9',
        '+','-','*','/','%','.','(',')'
      ]);

      function flashButtonByValue(valOrAction){
        const btn = document.querySelector(
          valOrAction === 'ac' || valOrAction === 'del' || valOrAction === 'eq'
            ? `button[data-action="${valOrAction}"]`
            : `button[data-val="${CSS.escape(valOrAction)}"]`
        );
        if (!btn) return;
        btn.classList.add('pressed');
        setTimeout(() => btn.classList.remove('pressed'), 120);
      }

      window.addEventListener('keydown', (e) => {
        const { key } = e;

        // Enter or = → equals
        if (key === 'Enter' || key === '=') {
          e.preventDefault();
          flashButtonByValue('eq');
          calculateResult();
          return;
        }

        // Backspace → delete last
        if (key === 'Backspace') {
          e.preventDefault();
          flashButtonByValue('del');
          deleteLastChar();
          return;
        }

        // Escape/Delete → clear all
        if (key === 'Escape' || key === 'Delete') {
          e.preventDefault();
          flashButtonByValue('ac');
          clearInput();
          return;
        }

        // Allowed direct keys (works for numpad too)
        if (allowedKeys.has(key)) {
          e.preventDefault();
          flashButtonByValue(key);
          updateExpression(key);
        }
      });
    })();
  </script>
</body>
</html>
